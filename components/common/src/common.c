/**
 * @file common.c
 * @author your name (you@domain.com)
 * @brief
 * @version 0.1
 * @date 2023-03-24
 *
 * @copyright Copyright (c) 2023
 *
 */
/***********************************************************************************************************************
 * Pragma directive
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * Includes <System Includes>
 ***********************************************************************************************************************/
#include "common.h"
#include "esp_system.h"
/***********************************************************************************************************************
 * Macro definitions
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * Typedef definitions
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * Private global variables and functions
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * Exported global variables and functions (to be accessed by other files)
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * Imported global variables and functions (from other files)
 ***********************************************************************************************************************/

/**
 * @brief
 *
 */
void user_sys_restart(void)
{
    esp_restart();
}

/**
 * @brief
 *
 * @return char*
 */
void user_sys_get_mac(char *mac)
{
    uint8_t eth_mac[6];

    esp_efuse_mac_get_default(eth_mac);
    snprintf(mac, 20, "%02X:%02X:%02X:%02X:%02X:%02X",
             eth_mac[0], eth_mac[1], eth_mac[2],
             eth_mac[3], eth_mac[4], eth_mac[5]);
}

/**
 * @brief
 *
 * @param devicename
 */
void user_sys_get_deviceName(char *devicename)
{
    uint8_t eth_mac[6];

    esp_efuse_mac_get_default(eth_mac);
    // snprintf(devicename, 20, "%02X%02X%02X%02X%02X%02X",
    //          eth_mac[0], eth_mac[1], eth_mac[2],
    //          eth_mac[3], eth_mac[4], eth_mac[5]);
    snprintf(devicename, 20, "%s", "44444");
}

/**
 * @brief add a device to the list of devices
 * 
 * @param device_address 
 */
uint8_t user_check_and_add_sub_device(uint16_t device_address)
{
    for (int i = 0; i < gateway_data.element_indx + 1; i++)
    {
        if (gateway_data.element_table_address[i] == device_address)
            return 0;
    }

    // add new sub device
    gateway_data.element_indx++;
    gateway_data.element_table_address[gateway_data.element_indx] = device_address;
    return 1;
}
/***********************************************************************************************************************
 * static functions
 ***********************************************************************************************************************/

/***********************************************************************************************************************
 * End of file
 ***********************************************************************************************************************/